E0=[0x00,0x10,0x13,0x04,0xbf,0xbf,0xb9,0xb9,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x00,0x10,0x13,0x04,0xbf,0xbf,0xb9,0xb9,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0]
Y=[0, 16,19,4, 191,185]

x0 =[ 25,9,6,21,90,96]

x1 = [195,179,176,191, 4,10]

x2 = [255,239,236,251, 64, 70]

x3 = [242,226,223,238, 51, 57]

x4 = [39, 23, 20,35]

x5 = [253 ,237 ,234,249,62,68]

x6 = [196,180,177,  192,  5, 11]

x7 = [210, 194, 191,206,19,25]

x8 = [20, 4, 1,16]

x9 = [227,211,208,223, 36, 42]

x10 = [193,177,174,189,2,8]

x11 = [202,186,183,198,11,17]

x12 = [38, 22, 19,34]

x13 = [239,223,220,235, 48,54]
x14 = [231,215,212,227,40,46]

x15 = [232,216,213,228, 41, 47]
x16=[0]
x17 = [126, 110, 107,122]

x18 = [239,223,220,235, 48, 54]

x19 = [198, 182, 179,194, 7,13]
x20=[3]

x21 = [235, 219, 216,231,44,50]

x22 = [222,206,203,218,31,37]

x23 = [197,181,178,193, 6, 12]

x24 = [46,30,27,42]

x25 = [255,239,236,251,64,70]

x26 = [227,211,208,223,36,42]

x27 = [242,226,223,238, 51, 57]

x28 = [57,41,38,53]

x29 = [247,231,228,243,56,62]

x30 = [193,177,174,189, 2, 8]

x31 = [222,206,203, 21, 31, 37]


#XOR'd flag is
# 22 1e 1b 4b 2d 17 05 0c-15 59 0e 78 23 26 33 2e  
# 10 07 4f 73 18 36 58 0b-29 0f 5c 3a 0c 62 76 21

XOR_flag=[0x22,0x1e,0x1b,0x4b,0x2d,0x17,0x05,0x0c,0x15,0x59,0x0e,0x78,0x23,0x26,0x33,0x2e,0x10,0x07,0x4f,0x73,0x18,0x36,0x58,0x0b,0x29,0x0f,0x5c,0x3a,0x0c,0x62,0x76,0x21]

X=[x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18,x19,x20,x21,x22,x23,x24,x25,x26,x27,x28,x29,x30,x31]
last_13="@flare-on.com"
d=[]

# for i in range (0,len(X)):
# 	for k in range(0,len(X[i])):
# 		temp=((X[i][k] & 0x2F) + ( 0xFF if (X[i][k] ==0x2F) else 0x00))
# 		if ( E0[ (temp if (temp & 0x80==0x80) else 0) & 31] ==Y[k] ):
# 			print "X%d value is %d\n"%(i,(X[i][k]))   
# 			d.append(X[i][k])
# 		#else:
# 			#print "X%d value %d doesnt work\n"%(i,(X[i][k]))
# for i in  d:
# 	 print hex(i)


for i in range (0,len(X)):
	for k in range(0,len(X[i])):
		temp = X[i][k] ^ XOR_flag[i]
		if ((temp <= 0x39 and temp>=0x30) or (temp >= 0x41 and temp <= 0x5A) or (temp==0x5F) or (temp <= 0x7A and temp >= 0x61) ) :
			print "Found valid byte at position %d : value = %c \n"%(i,chr(temp))



